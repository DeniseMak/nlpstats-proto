<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body


.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}


.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
}


.tab button:hover {
  background-color: #ddd;
}


.tab button.active {
  background-color: #ccc;
}

.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}

.tooltip {
  position: relative;
  display: inline-block;
  border-bottom: 1px dotted black;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 120px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 5px 0;
  position: absolute;
  z-index: 1;
  bottom: 125%;
  left: 50%;
  margin-left: -60px;
  opacity: 0;
  transition: opacity 0.3s;
}

.tooltip .tooltiptext::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}


.button {
  text-decoration: none;
  background-color: #EEEEEE;
  color: #333333;
  padding: 2px 6px 2px 6px;
}



</style>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type=text/javascript>
        // Note: This doesn't work for the file fields
        $(function() {
          $('a#process_input').bind('click', function() {
            $.getJSON('/', {

              eval_unit_size: $('input[name="eval_unit_size"]').val(),
              seed: $('input[name="seed"]').val(),
                system_file: $('input[name="system_file"]').val()

            }, function(data) {
                // Note: I don't think this is working.
              $('#result').text(data.result);
              $('#hist_score1').src(data.hist_score1);
              $('#hist_score2').src(data.hist_score2);
            });
            return false;
          });
        });
    </script>
    <script type="text/javascript">
        function da_submit_func() {
            console.log(document.getElementById('da_hidden').value)
            console.log("clicked DA submit!")
        }
        // document.getElementById('da_submit')
    </script>
</head>
<body>

<h2>Natural Language Processing System Performance
<button id="settings" name="settings" class="btn btn-primary">Settings</button> </h2>



<div class="tab">
  <button class="tablinks" onclick="openTab(event, 'Data Analysis')">Data Analysis</button>
  <button class="tablinks" onclick="openTab(event, 'Significance Test')">Significance Test</button>
  <button class="tablinks" onclick="openTab(event, 'Effect Size')">Effect Size</button>
  <button class="tablinks" onclick="openTab(event, 'Post-test Power Analysis')">Post-test Power Analysis</button>
  <button class="tablinks" onclick="openTab(event, 'Download Test Results')">Download Test Results</button>
</div>


<form
        action="/"
        class="form-horizontal"
        enctype="multipart/form-data"
        method="post">
<!-- Data Analysis
    TODO: Make style dynamic -->
<div id='Data Analysis' class="tabcontent" style="display:block">

  
  <!-- File Button -->
  <div class="form-group">
    
    <label class="col-md-4 control-label" for="system_file">System File:</label>
    
       <div class="tooltip">?
           <span class="tooltiptext">"{{help1}}"</span></div>
    <div class="col-md-4">
        <input type="file" id="system_file" name="system_file" style="display:none;" required/>
        <a href="#" class="button"><label for="system_file">Select</label></a> {{file_uploaded}}

         <!--
      <input id="system_file" name="system_file" class="input-file" type="file"/>
         -->
    
    </div>
  </div>
  <br>
  <!-- Text input-->
  <div class="form-group">
    <label class="col-md-4 control-label" for="eval_unit_size">Evaluation Unit Size:</label>
      <div class="tooltip">?
      <span class="tooltiptext">This should be a whole number between one and the number of data points.</span>
    </div>
    <div class="col-md-4">
    <input id="eval_unit_size" name="eval_unit_size" type="number"
           value="{{ eval_unit_size }}"
           class="form-control input-md" required="">  <!-- previously had value="1" -->
        

    </div>
  </div>
  <br>
  <!-- Data Analysis: Multiple Radios (inline)  -->
  <div class="form-group">
    <label class="col-md-4 control-label" for="target_statistic">Target Statistic:</label>
      <div class="tooltip">?
          <span class="tooltiptext">"{{help2}}"</span></div>
    <div class="col-md-4">
      <label class="radio-inline" for="target_statistic-0">
        <input type="radio" name="target_statistic" id="target_statistic-0" value="mean" checked="checked">
        Mean
      </label>
      <label class="radio-inline" for="target_statistic-1">
        <input type="radio" name="target_statistic" id="target_statistic-1" value="median">
        Median
      </label>
    </div>
  </div>
  <br>
  <!-- Text input-->
  <div class="form-group">
    <label class="col-md-4 control-label" for="seed">Random Seed:</label>
     <div class="tooltip">?
      <span class="tooltiptext">If you would like to provide a (real number) seed number, enter it here. Otherwise, we will shuffle.</span>
    </div>
     <div class="col-md-4">
    <input id="seed" name="seed" type="number" placeholder="Shuffle" step="0.01" class="form-control input-md">
    
    </div>
  </div>
  <br>
  <!-- Data Analysis Submit Button -->
  <div class="form-group">
    <label class="col-md-4 control-label" for="submit"></label>
    <div class="col-md-4">
        <input type="hidden" id="da_hidden" value="hidden101">
        <!-- Is type=submit implied by class="btn btn-success" -->
      <button id="submit"
              name="submit"
              type=submit
              class="btn btn-success"
              onsubmit="da_submit_func()">Run</button>
        <!-- Button for JS script-->
        <!-- <a href=# id=process_input><button class='btn btn-default' >Submit via JS</button></a> -->
    </div>
  </div>
 

    <div class="hiddendiv" id = "hidden">
    <!-- SUMMARY STATISTICS -->
          <h2>{{ summary_str }}</h2>
            {% if summary_stats_dict|length %}
                <table border = 1>

                    <tr><th>Score</th><th>mean</th><th>median</th><th>std_dev</th><th>min</th><th>max</th></tr>

                    {% for key, value in summary_stats_dict.items() %}

                        <tr>
                          <!--
                           <td> {{ key }} </td> <td>{{ value }}</td> -->
                        <td> {{ key }} </td>
                            {% for k, v in value.items() %}
                            <td>{{ v }}</td>
                                {% endfor %}
                        </tr>
                     {% endfor %}
                </table>
            {% endif %}

    <!-- RECOMMENDATION for test statistics -->
        <h2 id=teststat_heading align='left'>{{ teststat_heading }}</h2>
        {%  if mean_or_median %}
            <b>Normality:</b>The data distribution
            {% if is_normal %} passes {% else %} does not pass
            {% endif %} the normality test. <p></p>
            <b>Skewness:</b> The data distribution
            {% if mean_or_median == 'median' %} exceeds {% else %} does not exceed
                {% endif %} the skew threshold. <p></p>
            <b>Test statistic:</b> Based on the skewness, the recommended test statistic to use is:
                <b>{{ mean_or_median }}</b>
        {% endif %}

    <!-- RECOMMENDATION for significance tests with REASONS -->
          <h2 id=sigtest_heading align='left'>
              {{ result_str }}</h2>
                {% if recommended_tests_reasons|length %}
                    <table border = 1>

                    <tr><th>Test</th><th>Reason</th></tr>

                         {% for key, value in recommended_tests_reasons.items() %}
                            <tr>
                               <td> {{ key }} </td> <td>{{ value }}</td>
                            </tr>
                         {% endfor %}
                    </table>
                {% endif %}
        <!-- (Bulleted list example) -->
        <!--
                The following tests are recommended:
                <ul>
                  {% for name in recommended_tests %}
                  <li> {{ name }} (Reason: {{ test_reason }})</li>
                  {% endfor %}
                </ul>
                -->

    <!-- Images -->
        {% if hist_score1 %}
          <img id=hist_score1 src="{{ hist_score1 }}?{{ rand }}">
        {% endif %}
        {% if hist_score2 %}
          <img id=hist_score2 src="{{ hist_score2 }}?{{ rand }}">
        {% endif %}
        {% if hist_diff %}
          <img id=hist_diff src="{{ hist_diff }}?{{ rand }}">
        {% endif %}
        {% if hist_diff_par %}
          <img id=hist_diff_par src="{{ hist_diff_par }}?{{ rand }}">
        {% endif %}

    </div>
</div>
</form>  <!-- (comment out to try one form for all tabs -->


<!-- SIGNIFICANCE TEST TAB -->
<form
        action="/sig_test"
        class="form-horizontal"
        enctype="multipart/form-data"
        method="post">
<div id='Significance Test' class="tabcontent">
  <!-- <form class="form-horizontal"> -->

  <div class="form-group">
        <!-- SIGNIFICANCE TEST RECOMMENDATION for test statistics -->
          <h2 id=sigtest_heading align='left'>{{ result_str }}</h2>
            {% if recommended_tests_reasons|length %}
                <!--
                    <table border = 1>

                    <tr><th>Test</th><th>Reason</th></tr>

                         {% for key, value in recommended_tests_reasons.items() %}
                            <tr>
                               <td> {{ key }} </td> <td>{{ value }}</td>
                            </tr>
                         {% endfor %}
                    </table>
                <ul>
                         {% for key, value in recommended_tests_reasons.items() %}
                    <li>{{ key }}
                        <div class="tooltip">?
                            <span class="tooltiptext">{{ value }}</span>
                        </div>
                    </li>
                         {% endfor %}
                </ul>
                -->
           <!-- <h2>Choose the significance test to run</h2> -->
           <!-- radio button to choose test -->
                {% for key, value in recommended_tests_reasons.items() %}
                <label class="radio-inline" for="target_sig_test-1">
                <input type="radio" name="target_sig_test" id="target_sig_test-1" value={{ key }}>
                    {{ key }}
                        <div class="tooltip">?
                            <span class="tooltiptext">{{ value }}</span>
                        </div>
                </label> <p></p>
                {% endfor %}
            {% endif %}
            <!-- MOCKUP RADIO -->
      <h2>Choose the significance test to run</h2>
                  <label class="radio-inline" for="target_sig_test-1">
                <input type="radio" name="target_sig_test" id="target_sig_test-1" value=t>
                    t
                        <div class="tooltip">?
                            <span class="tooltiptext">help on t</span>
                        </div>
                </label> <p></p>
                    <label class="radio-inline" for="target_sig_test-1">
                <input type="radio" name="target_sig_test" id="target_sig_test-1" value=bootstrap>
                    bootstrap
                        <div class="tooltip">?
                            <span class="tooltiptext">help on bootstrap</span>
                        </div>
                </label> <p></p>
                    <label class="radio-inline" for="target_sig_test-1">
                <input type="radio" name="target_sig_test" id="target_sig_test-1" value=permutation_mean>
                    permutation_mean
                        <div class="tooltip">?
                            <span class="tooltiptext">help on permutation_mean</span>
                        </div>
                </label> <p></p>
                  <input type="radio" name="target_sig_test" id="target_sig_test-1" value=wilcoxson>
                    wilcoxson
                        <div class="tooltip">?
                            <span class="tooltiptext">help on wilcoxson</span>
                        </div>
                </label> <p></p>
                    <input type="radio" name="target_sig_test" id="target_sig_test-1" value=sign>
                    sign
                        <div class="tooltip">?
                            <span class="tooltiptext">help on sign</span>
                        </div>
                </label> <p></p>


        <br/>
    <label class="col-md-4 control-label" for="effect_size">Significance level &alpha;:</label>
      <div class="tooltip">?
        <span class="tooltiptext">The significance level.</span>
      </div>
    <div class="col-md-4">
    <input id="significance_level" name="significance_level" type="number" placeholder="0.00" class="form-control input-md" required="" step="0.01" min="0" max="1">
    </div>
  </div>
  
  <br>
  <div class="form-group">
    <label class="col-md-4 control-label" for="submit"></label>
    <div class="col-md-4">
        <input type="hidden" id="sa_hidden" value="hidden101">
        <!-- Is type=submit implied by class="btn btn-success" -->
      <button id="submit"
              name="submit"
              type=submit
              class="btn btn-success"
              >Run</button>
        <!-- Button for JS script-->
        <!-- <a href=# id=process_input><button class='btn btn-default' >Submit via JS</button></a> -->
    </div>

    <h2>Results</h2>
        <!-- <ul>
            <li><b>test statistic/CI:</b>1.65562</li>
            <li><b>p-value</b>: 0.098585</li>
            <li><b>Reject H0</b>: False</li>
        </ul> -->
        <table border="1">
            <tr><th>test statistic/CI</th>
                <td>{{ test_stat }}<!--1.65562--></td></tr>
            <tr><th>p-value</th>
                <td> {{ pval }}<!--0.098585--></td></tr>
            <tr><th>Reject H0</th>
                <td>{{ rejectH0 }}</td></tr>
        </table>
            <!--
            test name: t
            test statistic/CI: 1.6556223864889548
            p-value: 0.09858455289631643
            rejection of H0: False
            -->
  </div>

</div>
</form> <!-- sig test tab -->

<!-- Effect Size -->
<form
        action="/effectsize"
        class="form-horizontal"
        enctype="multipart/form-data"
        method="post">
<div id='Effect Size' class="tabcontent">
<div>
    Significance test: <p></p>
                      <label class="radio-inline" for="target_sig_test-1">
                <input type="radio" name="target_sig_test" id="target_sig_test-1" value=t>
                    t
                        <div class="tooltip">?
                            <span class="tooltiptext">help on t</span>
                        </div>
                </label> <p></p>
                    <label class="radio-inline" for="target_sig_test-1">
                <input type="radio" name="target_sig_test" id="target_sig_test-1" value=bootstrap>
                    bootstrap
                        <div class="tooltip">?
                            <span class="tooltiptext">help on bootstrap</span>
                        </div>
                </label> <p></p>
                    <label class="radio-inline" for="target_sig_test-1">
                <input type="radio" name="target_sig_test" id="target_sig_test-1" value=permutation_mean>
                    permutation_mean
                        <div class="tooltip">?
                            <span class="tooltiptext">help on permutation_mean</span>
                        </div>
                </label> <p></p>
                  <input type="radio" name="target_sig_test" id="target_sig_test-1" value=wilcoxson>
                    wilcoxson
                        <div class="tooltip">?
                            <span class="tooltiptext">help on wilcoxson</span>
                        </div>
                </label> <p></p>
                    <input type="radio" name="target_sig_test" id="target_sig_test-1" value=sign>
                    sign
                        <div class="tooltip">?
                            <span class="tooltiptext">help on sign</span>
                        </div>
                </label> <p></p>
</div>
  <!-- Effect Size Multiple Radios (inline)  -->
  <div class="form-group">
    <label class="col-md-4 control-label" for="target_statistic">Target Statistic:</label>
    <div class="col-md-4">
      <label class="radio-inline" for="target_statistic-0">
        <input type="radio" name="effect_size_target_statistic" id="target_statistic-0" value="mean" checked="checked">
        Mean
      </label>
      <label class="radio-inline" for="target_statistic-1">
        <input type="radio" name="effect_size_target_statistic" id="target_statistic-1" value="median">
        Median
      </label>
    </div>
  </div>
  
  <br>
  <!-- effect size Submit Button -->
  <div class="form-group">
    <label class="col-md-4 control-label" for="submit"></label>
    <div class="col-md-4">
        <input type="hidden" id="da_hidden" value="hidden101">
        <!-- Is type=submit implied by class="btn btn-success" -->
      <button id="ef_submit"
              name="ef_submit"
              type=submit
              class="btn btn-success"
              onsubmit="ef_submit_func()">Run</button>
        <!-- Button for JS script-->
        <!-- <a href=# id=process_input><button class='btn btn-default' >Submit via JS</button></a> -->
    </div>
  </div>
    <div>
            <h2>Results</h2>
        <!-- <ul>
            <li><b>test statistic/CI:</b>1.65562</li>
            <li><b>p-value</b>: 0.098585</li>
            <li><b>Reject H0</b>: False</li>
        </ul> -->
        <table border="1">
             <tr><th>Estimator</th><th>Effect Size</th></tr>
            <tr><td>Cohen's d</td><td>0.0828</td></tr>
            <tr><td>Hedges' g</td><td> 0.0826</td></tr>

        </table>
    </div>
</div> <!-- end Effect Size tab -->

</form>
<!-- end form Effect Size tab -->


<div id='Post-test Power Analysis' class="tabcontent">
  <form class="form-horizontal">
 



  <!-- Multiple Radios -->
  <div class="form-group">
      
          <label class="col-md-4 control-label" for="effect_size">Effect Size:</label> <div class="tooltip">?<span class="tooltiptext">"{{help1}}"</span></div>
          <div class="col-md-4">
          <input id="effect_size" name="effect_size" type="number" placeholder="default" class="form-control input-md" required="">
            
          </div>
       <br>
             
             
      <label class="col-md-4 control-label" for="sample_size">Sample Size:</label> <div class="tooltip">?<span class="tooltiptext">"{{help1}}"</span> </div>
          <div class="col-md-4">
          <input id="start" name="start" type="number" placeholder="Start" class="form-control input-md" required="">
         <input id="end" name="end" type="number" placeholder="End" class="form-control input-md" required="">
           <input id="step_size" name="step_size" type="number" placeholder="Step Size" class="form-control input-md" required="">
          </div>

          <br>
          <label class="col-md-4 control-label" for="iterations">Iterations Per Sample Size:</label> <div class="tooltip">?<span class="tooltiptext">"{{help1}}"</span></div>
          <div class="col-md-4">
          <input id="iterations" name="iterations" type="number" placeholder="default" class="form-control input-md" required="">
            
          </div>

      
      <br>
      <label class="col-md-4 control-label" for="method">Power Analysis Method:</label> <div class="tooltip">?<span class="tooltiptext">"{{help1}}"</span></div>
    <div class="col-md-4">
    <div class="radio">
      <label for="method-0">
        <input type="radio" name="method" id="method-0" value="monte_carlo" checked="checked">
        Monte Carlo
      </label>
      </div>
    <div class="radio">
      <label for="method-1">
        <input type="radio" name="method" id="method-1" value="bootstrap">
        Bootstrap
      </label>
      </div>
    <div class="radio">
      <label for="method-2">
        <input type="radio" name="method" id="method-2" value="analysis">
        Analysis
      </label>
      </div>
    </div>
  </div>
    <br>
    <!-- Power Submit Button -->
    <div class="form-group">
      <label class="col-md-4 control-label" for="submit"></label>
      <div class="col-md-4">
          <input type="hidden" id="da_hidden" value="hidden101">
      
        <button id="ef_submit"
                name="ef_submit"
                type=submit
                class="btn btn-success"
                onsubmit="pa_submit_func()">Run</button>
      </div>
    </div>

  </form>
</div>

<div id='Download Test Results' class="tabcontent">
  <br>
  <button id="download" name="download" class="btn btn-primary">Download zip archive</button>

</div>

<script>
function openTab(evt, tabName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>


<script>
function showLastTab(tabToShow) {
  // document.getElementById("hidden").style.display="block"
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
    console.log('In showLastTab(), tabToShow=' + tabToShow);
    document.getElementById(tabToShow).style.display="block"
}
</script>



<div class="hiddendiv" id = "hidden">
    <b>Debugging info:</b> <p/>
    last tab: <p id=last_tab align="left">{{ last_tab_name_clicked }}</p>
</div>

<script>
    window.onload = showLastTab('{{ last_tab_name_clicked }}')
</script>
</body>




</html>
